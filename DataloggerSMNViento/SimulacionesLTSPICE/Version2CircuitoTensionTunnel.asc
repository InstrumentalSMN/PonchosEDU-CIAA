Version 4
SHEET 1 2628 680
WIRE -1120 -256 -1328 -256
WIRE -960 -256 -1120 -256
WIRE 1264 -240 1136 -240
WIRE 1136 -208 1136 -240
WIRE -1328 -176 -1328 -256
WIRE 80 -112 48 -112
WIRE 112 -112 80 -112
WIRE 272 -112 192 -112
WIRE -1584 -96 -1584 -160
WIRE -32 -96 -32 -112
WIRE 912 -96 576 -96
WIRE -1648 -48 -1712 -48
WIRE 1264 -48 1264 -240
WIRE 160 -32 -112 -32
WIRE -1120 -16 -1120 -256
WIRE -1472 0 -1584 0
WIRE -1472 32 -1472 0
WIRE -1328 32 -1328 -96
WIRE -1328 32 -1472 32
WIRE -1184 32 -1328 32
WIRE 160 32 160 -32
WIRE 576 32 576 -96
WIRE 688 32 576 32
WIRE 80 48 80 -112
WIRE 128 48 80 48
WIRE 912 48 912 -96
WIRE 912 48 752 48
WIRE 1104 48 912 48
WIRE 1264 48 1264 16
WIRE 1264 48 1184 48
WIRE 1312 48 1264 48
WIRE 1440 48 1392 48
WIRE -1840 64 -1888 64
WIRE -1712 64 -1712 -48
WIRE -1712 64 -1760 64
WIRE 272 64 272 -112
WIRE 272 64 192 64
WIRE 368 64 272 64
WIRE 480 64 368 64
WIRE 688 64 480 64
WIRE -928 80 -1008 80
WIRE -784 80 -848 80
WIRE -624 80 -784 80
WIRE -464 80 -544 80
WIRE -240 80 -464 80
WIRE 128 80 -240 80
WIRE -1328 96 -1328 32
WIRE -1120 96 -1120 80
WIRE -1008 96 -1008 80
WIRE -1008 96 -1120 96
WIRE 1440 96 1440 48
WIRE 1264 112 1264 48
WIRE -1120 128 -1120 96
WIRE -784 128 -784 80
WIRE -464 128 -464 80
WIRE -112 144 -112 -32
WIRE 480 144 480 64
WIRE -1472 176 -1472 32
WIRE -1472 176 -1584 176
WIRE -1712 224 -1712 64
WIRE -1648 224 -1712 224
WIRE 1264 224 1264 176
WIRE -1888 240 -1888 64
WIRE -784 272 -784 192
WIRE -464 272 -464 192
WIRE -464 272 -784 272
WIRE -112 288 -112 224
WIRE 160 288 160 96
WIRE 160 288 -112 288
WIRE -784 320 -784 272
WIRE -1584 336 -1584 272
WIRE -1888 352 -1888 320
WIRE -112 352 -112 288
FLAG -1888 64 vPWM
FLAG -240 80 vout
FLAG -784 320 0
FLAG -32 -96 0
FLAG 368 64 VadcTunnel
FLAG -112 -32 VCC5V
FLAG -1584 -160 VCC10V
FLAG -1584 336 0
FLAG -1888 352 0
FLAG -112 352 0
FLAG -1120 208 0
FLAG -1328 176 0
FLAG -960 -256 VCC5V
FLAG 720 80 0
FLAG 720 16 VCC5V
FLAG 480 224 0
FLAG 1264 224 0
FLAG 1136 -128 0
FLAG 1440 176 0
FLAG 1440 48 VAdcCIAA
SYMBOL voltage -1888 224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -422 -26 Left 2
SYMATTR Value PULSE(0 3.3 0 10n 10n 100u 100u 0)
SYMATTR InstName V1
SYMBOL res -832 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL cap -800 128 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL voltage -112 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -528 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL cap -480 128 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL res 208 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3Variable
SYMATTR Value 4000
SYMBOL res 64 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 4k7
SYMBOL OpAmps\\opamp2 160 0 R0
SYMATTR InstName U1
SYMATTR Value LMX58_LM2904
SYMBOL npn -1648 -96 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res -1744 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL pnp -1648 272 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL npn -1184 -16 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res -1136 112 R0
SYMATTR InstName R6
SYMATTR Value 47
SYMBOL res -1344 -192 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res -1344 80 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 720 -16 R0
SYMATTR InstName U2
SYMATTR Value LMX58_LM2904
SYMBOL res 464 128 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL res 1200 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 47K
SYMBOL schottky 1280 16 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 1280 176 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5817
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 1136 -224 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL res 1408 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1K
SYMBOL res 1424 80 R0
SYMATTR InstName R11
SYMATTR Value 1.2Meg
TEXT -664 336 Left 2 !.tran 0 22m 0
TEXT -336 -224 Left 2 !.include libraryTesisModelSpice.lib
TEXT -1888 -448 Left 2 !.MODEL BD136_138_140 PNP ( IS=2.9537E-13 BF=201.4 NF=1.0 BR=23.765 NR=1.021 ISE=1.8002E-13 NE=1.5 ISC=7.0433E-12 + NC=1.38 VAF=137.0 VAR=8.41 IKF=1.0993 IKR=0.10 RB=1.98 RBM=0.01 IRB=0.011 RE=0.1109 RC=0.01 CJE=2.1982E-10 + VJE=0.7211 MJE=0.3685 FC=0.5 CJC=6.8291E-11 VJC=0.5499 MJC=0.3668 XCJC=0.5287 XTB=1.4883 EG=1.2343 XTI=3.0)
TEXT -1896 -408 Left 2 !.MODEL BD135_137_139 NPN ( IS=2.3985E-13 BF=244.9 NF=1.0 BR=78.11 NR=1.007 ISE=1.0471E-14 NE=1.2 ISC=1.9314E-11 + NC=1.45 VAF=98.5 VAR=7.46 IKF=1.1863 IKR=0.1445 RB=2.14 RBM=0.001 IRB=0.031 RE=0.0832 RC=0.01 CJE=2.92702E-10 + VJE=0.67412 MJE=0.3300 FC=0.5 CJC=4.8831E-11 VJC=0.5258 MJC=0.3928 XCJC=0.5287 XTB=1.1398 EG=1.2105 XTI=3.0)
